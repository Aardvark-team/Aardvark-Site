let TokenTypes=["String","Number","Keyword","Operator","Identifier","Delimiter","Indent","Comment","LineBreak","Boolean"],Booleans=["true","false"],PureOperators=["=","!","~","<",">","==","<=",">=","!=","~=","&","|","x|","+","-","/","*","^","%","@","?","->","not","and","or","xor","in","++","--","$=","..."],Operators=PureOperators.concat(["not","and","or","xor","in"]),OrderOfOps={0:["?"],1:["~","!","@","..."],2:["^"],3:["*","/"],4:["-"],5:["-","+","%"],6:["++","--","=","+=","-=","*=","/=","^=","%="],7:["~=","<",">","<=",">=","!=","in","==","$="],8:["&","|","x|","and","or","xor","->"]},Quotes=['"',"'","`"],Whitespaces=[" ","\t","​"," "," "," "," "," "," "," "," "," ","⠀"],Delimiters=[":","(",")",",","{","}","[","]","."],Keywords=["class","extends","extending","function","for","while","match","case","if","else","return","static","include","await","pause-until","yield","let","as","from","defer","layout","break","continue","private","set","get","macro"];class Token{constructor(type,start,end,line,value=null,variation=null){this.type=type,this.start=start,this.end=end,this.line=line,this.value=value,this.variation=variation,this.length=end-start}}class Lexer{constructor(singleline="#",multilineStart="#*",multilineEnd="*#",comments=False){this.singleline=singleline,this.multilineStart=multilineStart,this.multilineEnd=multilineEnd,this.doComments=comments,this.data="",this.output=[],this.line=1,this.column=1,this.index=0,this.empty=!0,this.AtEnd=!1,this.curChar=""}isWhitespace(char){return Whitespaces.includes(char||this.curChar)}isNewline(char){return[";","\n"].includes(char||this.curChar)}isQuote(char){return Quotes.includes(char||this.curChar)}isDelimiter(char){return Delimiters.includes(char||this.curChar)}isNumber(char){return["0","1","2","3","4","5","6","7","8","9"].includes(char||this.curChar)}detect(text){if(this.curChar!==text[0])return!1;for(let i=0;i<text.length-1;i++)if(this.peek(i+1)!==text[i+1])return!1;return!0}addToken(...args){this.output.push(new Token(...args)),this.empty=!1}otherwise(char){return char=char||this.curChar,!(this.isWhitespace(char)||this.isNewline(char)||this.isQuote(char)||this.isDelimiter(char)||this.isNumber(char)||PureOperators.includes(char)||char===this.comment)}newline(){this.line++,this.empty=!0,this.column=1}advance(amt=1){this.index+=amt,this.column+=amt,this.index<this.data.length?this.curChar=this.data[this.index]:this.AtEnd=!0}peek(amt=1){return this.index+amt<this.data.length?this.data[this.index+amt]:null}tokenize(data){if(""===data)return this.output;for(this.data+=data,this.curChar=this.data[this.index];this.index<this.data.length;){if(this.isNewline())this.addToken("LineBreak",this.index,this.index,this.line,this.curChar,this.curChar),"\n"===this.curChar?this.newline():this.empty=!0;else if(this.isDelimiter())this.addToken("Delimiter",this.index,this.index,this.line,this.curChar);else if(this.isNumber()){let start=this.index,value="",seen_dot=!1;for(;(this.isNumber()||"."===this.curChar)&&!this.AtEnd;){if(seen_dot&&"."===this.curChar)throw`Invalid syntax, floats can only have one . ${seen_dot}`;"."===this.curChar&&(seen_dot=!0),value+=this.curChar,this.advance()}this.advance(-1),this.addToken("Number",start,this.index,this.line,value)}else{if(this.detect(this.multilineStart)){let value="",start=this.index;for(;!this.detect(this.multilineEnd)&&!this.AtEnd;)value+=this.curChar,this.advance();let wasAtEnd=this.AtEnd;this.advance(this.multilineEnd.length),this.doComments&&this.addToken("Comment",start,this.index,this.line,value+(wasAtEnd?"":this.multilineEnd));continue}if(this.detect(this.singleline)){let value="",start=this.index;for(;!this.isNewline()&&!this.AtEnd;)value+=this.curChar,this.advance();this.doComments&&this.addToken("Comment",start,this.index,this.line,value),this.advance(-1)}else if(this.isQuote()){let variation=this.curChar,value="",start=this.index;for(;!this.AtEnd&&(this.advance(),(this.curChar!==variation||0!==value.length&&"\\"==value[value.length-1])&&!this.AtEnd);)value+=this.curChar;this.addToken("String",start,this.index,this.line,value,variation)}else if(PureOperators.includes(this.curChar)){let value="",start=this.index;for(;!this.AtEnd&&Operators.includes(value+this.curChar);)value+=this.curChar,this.advance();this.advance(-1),this.addToken("Operator",start,this.index,this.line,value)}else if(this.otherwise()){let type,value="",start=this.index;for(;(this.otherwise()||this.isNumber())&&!this.AtEnd;)value+=this.curChar,this.advance();type=Operators.includes(value)?"Operator":Keywords.includes(value)?"Keyword":"Identifier",this.advance(-1),this.addToken(type,start,this.index,this.line,value)}}if(this.AtEnd)break;this.advance()}return this.output}}let styles={String:"color: rgb(152, 195, 121);",Function:"color: rgb(97, 175, 239);",Number:"color: rgb(229, 192, 123);",Keyword:"color: rgb(224, 108, 117);",Operator:"color: rgb(86, 182, 194);font-weight: bold;",Boolean:"color: rgb(229, 192, 123);",Comment:"color: rgb(101, 109, 123);font-style: italic;",Delimiter:"color: rgb(245, 245, 255);",default:"color: rgb(203, 212, 227);",suggestion:"color: rgb(255, 165, 0);",none:""};function Style(style,code){let span=document.createElement("span");return span.style=styles[style],span.innerText=code,span.outerHTML}function Highlight(code,opts={}){let lexer=new Lexer("#","#*","*#",!0);lexer.tokenize(code);opts.startline;let output="",toknum=0,last=0;for(let token of lexer.output)token.start>last+1&&(output+=Style("default",code.slice(last+1,token.start))),"String"===token.type?output+=Style("String",token.variation+token.value+token.variation):"\n"===token.value?(output+="<br/>"):"Identifier"===token.type&&toknum<lexer.output.length-1&&"("===lexer.output[toknum+1].value?output+=Style("Function",token.value):token.type in styles?output+=Style(token.type,token.value):output+=Style("default",token.value),toknum+=1,last=token.end;return output}function HighlightAll(){tags=["code h1","code h2","code h3","code h4","code h5","code h6","pre code"];for(let tag of tags)for(let elem of document.querySelectorAll(tag)){if(elem.hasAttribute("noh"))continue;if(elem.classList.contains("highlighted"))continue;let output=Highlight(elem.innerText);elem.innerHTML=output,elem.classList.add("highlighted")}for(let elem of document.querySelectorAll("code")){if(elem.hasAttribute("noh"))continue;if(elem.children.length>0)continue;if(elem.classList.contains("highlighted"))continue;let output=Highlight(elem.innerText);elem.innerHTML=output,elem.classList.add("highlighted")}}export{HighlightAll,Highlight,Style};